(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
module.exports={setGame:function(t){this.game=t},drawPolygonOn:function(t,o,e,a,n){o=this.rotatePolygon(o,n);var r=o.toNumberArray();t.ctx.fillStyle=a,t.ctx.strokeStyle=e,t.ctx.beginPath(),t.ctx.moveTo(r[0],r[1]);for(var i=2;i<r.length;i+=2)t.ctx.lineTo(r[i],r[i+1]);return t.ctx.lineTo(r[0],r[1]),t.ctx.fill(),t.ctx.stroke(),t.ctx.closePath(),t.polygon=o,t},drawIsoTriangle:function(t,o,e,a,n,r,i){var g=this.makeIsoTrianglePolygon(t,o,e,a);g=this.rotatePolygon(g,i);var h=this.getPolygonRect(g);return this.drawPolygonOn(this.game.add.bitmapData(h[0]+h[2],h[1]+h[3]),g,n,r,0)},drawIsoTriangleOn:function(t,o,e,a,n,r,i,g){var h=this.makeIsoTrianglePolygon(o,e,a,n);return h=this.rotatePolygon(h,g),this.drawPolygonOn(t,h,r,i,0)},makeIsoTrianglePolygon:function(t,o,e,a){return new Phaser.Polygon([t,o,e+t,a/2+o,t,a+o])},getPolygonRect:function(t){for(var o=t.toNumberArray(),e=x1=o[0],a=0;a<o.length;a+=2)e=this.game.math.min(e,o[a]),x1=this.game.math.max(x1,o[a]);for(var n=y1=o[1],r=1;r<o.length;r+=2)n=this.game.math.min(n,o[r]),y1=this.game.math.max(y1,o[r]);return[e,n,x1-e,y1-n]},rotatePolygon:function(t,o){if(0==o)return t;for(var e=t.toNumberArray(),a=this.getPolygonRect(t),n=[a[2]/2+a[0],a[3]/2+a[1]],r=e[0],i=e[1],g=0;g<e.length;g+=2){var h=this.game.math.angleBetween(n[0],n[1],e[g],e[g+1]),m=this.game.math.distance(e[g],e[g+1],n[0],n[1]);h+=o,e[g]=this.game.math.roundTo(Math.cos(h)*m,-2)+n[0],e[g+1]=this.game.math.roundTo(Math.sin(h)*m,-2)+n[1],r=this.game.math.min(r,e[g]),i=this.game.math.min(i,e[g+1])}for(g=0;g<e.length;g+=2)e[g]-=r,e[g+1]-=i;return new Phaser.Polygon(e)}};

},{}],2:[function(require,module,exports){
window.onload=function(){function e(){w.setGame(h),h.stage.backgroundColor="#111111",g={redTriangle:w.drawIsoTriangle(0,0,40,30,"#ffffff","#ff0000",0),blueTriangle:w.drawIsoTriangle(0,0,40,30,"#ffffff","#0000ff",0)}}function o(){h.physics.startSystem(Phaser.Physics.P2JS),h.physics.p2.setImpactEvents(!0),b=h.physics.p2.createCollisionGroup(),m=h.physics.p2.createCollisionGroup(),u={},u.space=h.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),y=h.make.sprite(h.width/2,h.height,g.redTriangle),y.isDying=!1,h.world.add(y),h.physics.p2.enableBody(y),y.body.clearShapes(),y.body.addPolygon({},g.redTriangle.polygon.toNumberArray()),y.body.fixedRotation=!0,y.body.setCollisionGroup(b),y.body.collides([m],a),p=h.make.group(),p.enableBody=!0,p.physicsBodyType=Phaser.Physics.P2JS,h.world.add(p),v={style:{font:"65px Arial",fill:"#FFFFFF",align:"center"}},v=h.make.text(0,h.height/4,"Error",v.style),t()}function i(){y.alive&&c(),p.forEachAlive(function(e){e.y>h.height+e.height/2&&e.kill()})}function n(){}function t(){y.revive(),f=h.time.events.loop(3e3,d),y.body.collideWorldBounds=!1,y.scale=new Phaser.Point(1,1),y.angle=-90,d(),u.space.onDown.removeAll(),y.score=0,h.world.remove(v)}function a(e,o,i,n){y.alive&&(y.alive=!1,y.body.collideWorldBounds=!0,h.time.events.remove(f),r(y),p.forEachAlive(r),y.isDying=!0)}function r(e){var o=h.add.tween(e).to({angle:-e.angle},1500);o.onComplete.add(s),o.start(),h.add.tween(e.scale).to({x:0,y:0},1500).start()}function s(){y.kill(),p.forEachAlive(function(e){e.events.onKilled.removeAll(),e.kill()}),u.space.onDown.add(t),v.setText("The game is over.\n You have scored "+y.score+" points!\n Press space to restart"),h.world.add(v),y.isDying=!1}function d(){if(y.score++,!y.isDying){var e=p.getFirstDead();e||(p.add(l()),e=p.getFirstDead()),e.scale=new Phaser.Point(1,1),e.events.onKilled.add(d),e.angle=90,e.body.reset(h.rnd.between(e.width/2,h.width-e.width/2),-e.height/2),e.body.velocity.y=h.rnd.between(50,250),e.revive()}}function l(){var e=h.make.sprite(0,0,g.blueTriangle);return e.kill(),h.physics.p2.enableBody(e),e.body.damping=0,e.body.clearShapes(),e.body.addPolygon({},g.blueTriangle.polygon.toNumberArray()),e.body.fixedRotation=!0,e.body.collideWorldBounds=!1,e.body.setCollisionGroup(m),e.body.collides([b]),e}function c(){y.body.reset(h.math.min(h.width-y.width/2,h.math.max(y.width/2,h.input.activePointer.position.x)),h.math.min(h.height-y.height/2,h.math.max(y.height/2,h.input.activePointer.position.y)))}var h=new Phaser.Game(800,600,Phaser.AUTO,"",{preload:e,create:o,update:i,render:n});console.log("Remember to use Phaser.min.js instead of Phaser.js on release");var y,p,f,g,u,b,m,v,w=require("./bitmaptools.js")};
},{"./bitmaptools.js":1}]},{},[2]);
